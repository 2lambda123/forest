\chapter{Penums}
\label{chap:enums}
\Penum{}s allow a fixed collection of source strings to be converted into
integers in-memory.

\section{Syntax}
\begin{tabular}{rcl}
\nont{p\_enum\_prefix}      & \is{}  & \kw{Pprefix} ( identifier ) \\
\nont{p\_from}              & \is{}  & \pfrom{} ( identifier ) \\
\nont{p\_raw\_enum\_field}  & \is{}  & identifier \opt{\nont{p\_from}} \opt{= expression } \\
\nont{p\_enum\_field}       & \is{}  & \nont{p\_raw\_enum\_field}, \opt{p\_comment}\\
\nont{p\_last\_enum\_field} & \is{}  & \nont{p\_raw\_enum\_field} \opt{p\_comment}\\
\nont{p\_enum\_fields}   & \is{}  & \nont{p\_last\_enum\_field} \\
                         & \alt{} & \nont{p\_enum\_field} \nont{p\_enum\_fields} \\
\nont{enum\_ty}    & \is{} & \Penum{} identifier \opt{\nont{p\_formals}} \opt{\nont{p\_enum\_prefix}} \{ \nont{p\_enum\_fields} \} ;\\[4ex]
\end{tabular}

\subsection{Example}
If the on-disk representation consists of the following strings:\texttt{S\_init}, \texttt{S\_lec},
\texttt{S\_care}, \texttt{S\_for}, \texttt{S\_if}, and
\texttt{S\_tpv},
we can use the specification: 
\input{code/enum.tex}

\section{Generated library}
\subsection{In-memory representation}
\label{sec:enums-rep}
\subsection{Mask}
\label{sec:enums-masks}
\subsection{Parse descriptor}
\label{sec:enums-parse-descriptors}

\subsection{Operations}
init/cleanup rep
init/cleanup ed
\subsubsection{read}
  error codes
\subsubsection{Accumulator functions}

