\begin{code}
\kw{Precord} \kw{Pstruct} summary\_header\_t \{  "0|";  Puint32 tstamp; \};
\mbox{}
\kw{Pstruct} no\_ramp\_t \{ "no\_ii";  Puint64 id; \};
\mbox{}
\kw{Punion} dib\_ramp\_t \{
  Pint64     ramp;
  no\_ramp\_t  genRamp;
\};
\mbox{}
\kw{Pstruct} order\_header\_t \{
       Puint32             order\_num;
 '|';  Puint32             att\_order\_num;
 '|';  Puint32             ord\_version;
 '|';  \kw{Popt} pn\_t           service\_tn;
 '|';  \kw{Popt} pn\_t           billing\_tn;
 '|';  \kw{Popt} pn\_t           nlp\_service\_tn;
 '|';  \kw{Popt} pn\_t           nlp\_billing\_tn;
 '|';  \kw{Popt} Pzip           zip\_code;
 '|';  dib\_ramp\_t          ramp;
 '|';  Pstring(:'|':)      order\_type;
 '|';  Puint32             order\_details;
 '|';  Pstring(:'|':)      unused;
 '|';  Pstring(:'|':)      stream;
 '|';
\};
\mbox{}
\kw{Pstruct} event\_t \{
  Pstring(:'|':) state;   '|';
  Puint32        tstamp;
\};
\mbox{}
\kw{Parray} eventSeq \{
  event\_t[] : \kw{Psep}('|') && \kw{Pterm}(\kw{Peor});
\} \kw{Pwhere} \{
  \kw{Pforall} (i \kw{Pin} [0..length-2] : (elts[i].tstamp <= elts[i+1].tstamp));
\};
\mbox{}
\kw{Precord} \kw{Pstruct} entry\_t \{
  order\_header\_t  header;
  eventSeq        events;
\};
\mbox{}
\kw{Parray} entries\_t \{  entry\_t[]; <\};
\mbox{}
\kw{Psource} \kw{Pstruct} out\_sum\{
  summary\_header\_t  h;
  entries\_t         es;
\};
\end{code}
